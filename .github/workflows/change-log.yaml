name: Changelog CI

on:
  push:
    branches:
      - feature/change-log
  pull_request_target:
    branches:
      - main

jobs:
  Change-log:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v2
      - name: Git config
        run: git config --global user.email "dev@llt.com" |
          git config --global user.name "dev"
      - name: Setup golang
        uses: WillAbides/setup-go-faster@v1.7.0
        with:
          go-version: '1.18.1'
      - name: Install git-chglog
        run: go install github.com/git-chglog/git-chglog/cmd/git-chglog@latest
      - name: Gen changelog
        run: git-chglog -o CHANGELOG.md
      - name: Git push
        run: git add . |
          git commit -m "docs(changelog):generating change logs"
          git push -u
